<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»“åº“ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        :root { --primary: #007bff; --success: #28a745; --danger: #dc3545; --warning: #ffc107; }
        body { font-family: -apple-system, sans-serif; background-color: #f4f7f6; margin: 0; padding: 15px; }
        .container { width: 100%; max-width: 800px; margin: 0 auto; }
        h2 { text-align: center; color: #333; margin-bottom: 20px; font-weight: 400; }
        
        /* æœç´¢æ¡† */
        #searchInput { width: 100%; padding: 15px; border-radius: 25px; border: 1px solid #ddd; box-shadow: 0 4px 10px rgba(0,0,0,0.05); font-size: 16px; outline: none; box-sizing: border-box; margin-bottom: 20px; }
        #searchInput:focus { border-color: var(--primary); }

        /* åŠŸèƒ½æŒ‰é’® */
        .btn-group { display: flex; gap: 10px; margin-bottom: 20px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 8px; color: white; font-size: 14px; cursor: pointer; }
        .btn-blue { background: var(--primary); }
        .btn-orange { background: var(--warning); color: #333; }

        /* è¡¨æ ¼æ ·å¼ */
        .card { background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); overflow: hidden; display: none; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f8f9fa; padding: 12px; text-align: left; font-size: 13px; color: #666; border-bottom: 1px solid #eee; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 14px; vertical-align: middle; }
        .loc-tag { background: #eee; padding: 2px 6px; border-radius: 4px; font-weight: bold; font-family: monospace; }
        .returned { text-decoration: line-through; color: #aaa; }
    </style>
</head>
<body>

<div class="container">
    <h2>ä»“åº“é›¶ä»¶ç®¡ç†ç³»ç»Ÿ</h2>
    
    <input type="text" id="searchInput" placeholder="æœç´¢é›¶ä»¶åã€é›¶ä»¶å·æˆ–åº“ä½..." oninput="handleSearch()">

    <div class="btn-group">
        <button class="btn-orange" onclick="showHistory()">ğŸ“‹ å€Ÿè¿˜æ¸…å•è®°å½•</button>
        <button class="btn-blue" onclick="alert('å½“å‰åº“å­˜ç§ç±»ï¼š' + parts.length)">ğŸ“Š åº“å­˜ç»Ÿè®¡</button>
    </div>

    <div id="displayArea" class="card">
        <table id="dataTable">
            <thead id="tHead"></thead>
            <tbody id="tBody"></tbody>
        </table>
    </div>
</div>

<script>
// è¿™é‡Œå¡«å…¥ä½ ä¹‹å‰æä¾›çš„å…¨éƒ¨é›¶ä»¶æ•°æ®ï¼ˆå·²ç²¾ç®€å±•ç¤ºï¼Œéƒ¨ç½²æ—¶å»ºè®®è´´å…¥å…¨éƒ¨ï¼‰
let parts = JSON.parse(localStorage.getItem('parts_data')) || [
    ["1-1","æ²¹æ»¤èŠ¯","026W32831-000","4",""],["1-1","é˜€","955A0040H06","1",""],["1-1","å«ç‰‡","028-14434-000","2",""],["1-1","å«ç‰‡","028-14433-000","1",""],["1-1","å«ç‰‡","029-22714-000","1",""],["1-1","çº¿æŸ","571W06854-271","1",""],["1-2","å‹åŠ›ä¼ æ„Ÿå™¨","025W47072-006","1",""],["1-2","ç”µæ± ","025W39729-000","3",""],["1-2","æ¥å¤´","023W25397-000","2",""],["1-2","å¡æ‰£","021G00072A007","2",""],["1-2","ç»§ç”µå™¨åº•åº§","024W33829-032","3",""],["1-2","è¾…åŠ©è§¦ç‚¹","024W33857-381","7",""],["1-2","å‹åŠ›ä¼ æ„Ÿå™¨","025W40088-000","1",""],["1-2","å‹å·®å¼€å…³åº•åº§","073W44110-000","1",""],["1-2","å‹å·®æ°´æµå¼€å…³","024W33848-000","1",""],["1-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025W48195-101","1",""],["1-2","çƒé˜€","022W13503-000","2",""],["1-2","æ°´å®¤å«åœˆ","092W18800-007","1",""],["1-2","æ°´å®¤å«åœˆ","092W18800-008","1",""],["1-3","è§’é˜€","022-09756-000","1",""],["1-3","ç”µæº","025-34111-000","1",""],["1-3","è½¯ç®¡","028W17886-002","12",""],["1-3","è½¯ç®¡","028W17771-000","12",""],["1-3","æ¸©åº¦ä¼ æ„Ÿå™¨","028W48195-001","1",""],["1-3","æ¶²ä½æ‰§è¡Œå™¨","025W38177-001","2",""],["1-4","æ¶²ä½æ‰§è¡Œå™¨","025W38178-001","1",""],["1-4","é«˜å‹å¼€å…³","225-27165-002","1",""],["1-4","å‹å·®å¼€å…³","024G00018-008","1",""],["1-4","å«ç‰‡","028W15785-013","1",""],["1-5","å¯¼å¶é©¬è¾¾","025W48234-000","1",""],["1-5","ç”µæœºé£ç›˜","1051943","1",""],["1-5","è¿‡æ»¤å™¨","026-32839-000","4",""],["2-1","è¿‡æ»¤å™¨","026W37563-001","4",""],["2-1","è¿‡æ»¤å™¨","026-32839-000","2",""],["2-1","ä¸»æ¿","331-02430-601","1",""],["2-1","å†·å´æ¶²","013-04129-000","1",""],["2-1","ä¼ æ„Ÿå™¨","534D1251H03","1",""],["2-2","å¡æ‰£","021w34347-000","3",""],["2-2","è¿‡æ»¤å™¨","026-18328-000","8",""],["2-4","è§¦å‘æ¿","031-02060-002","2",""],["2-4","å†·å´æ¶²","013-04129-000","1",""],["2-4","æµ®çƒå¼€å…³","","8",""],["2-5","æ™¶æ¾³ç»„ä»¶","","1ç®±",""],["3-1","æ²¹æ»¤èŠ¯","026W32831-000","7",""],["3-1","è½´å°","534C1325H03","1",""],["3-1","è½´å°","534C1325H02","1",""],["3-1","åŠ æ¹¿å™¨ç”µæ§ç®±","026G63000-089","1",""],["3-2","å¹²ç‡¥è¿‡æ»¤å™¨","026W37563-001","1",""],["3-2","å¹²ç‡¥è¿‡æ»¤å™¨","026-37563-000","1",""],["3-2","æ²¹åŠ çƒ­å™¨","025W00084-000","1",""],["3-2","æ°´å®¤å¯†å°å«","092W09935-001","2",""],["3-2","ä¸»æ¿","024W33745-000","2",""],["3-2","VGDæ§åˆ¶æ¿","031-02418-001","1",""],["3-2","ç”µå®¹","025-35972-000","3",""],["3-2","å‹åŠ›ä¼ æ„Ÿå™¨","025W40088-000","1",""],["3-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025W29964-000","1",""],["3-2","æ–­è·¯å™¨","024W3363-545","1",""],["3-3","æ°´æµå¼€å…³","024G00009-014","3",""],["3-3","å‹å·®æ°´æµå¼€å…³","024W33898-000","2",""],["3-3","ç”µç£é˜€çº¿åœˆ","025W42531-000","1",""],["3-3","ç”µç£çº¿åœˆ","025-28989-000","1",""],["3-3","ç”µç£é˜€","025-47112-000","1",""],["3-3","è§†æ¶²é•œ","026-37571-000","1",""],["3-3","ç”µç£é˜€","030-21946-017-","2",""],["3-3","æ°´æ³µå®‰è£…é’£é‡‘","371W06644-391","1",""],["3-4","ä¸»æ¿","031-03630-601","1",""],["3-4","ä¸»æ¿","331-02506-601","1",""],["3-4","è¶é˜€","022-10642-004","1",""],["3-4","ç”µå­è†¨èƒ€é˜€","025-45331-003","1",""],["3-5","æ§åˆ¶æ¿","025W43786-548","1",""],["3-5","è½´å°","029-24762-000","1",""],["4-1","æ˜¾ç¤ºå±","025W00088-000","1",""],["4-1","ä¸»æ§æ¿","024W33782-000","1",""],["4-1","CPUæ¨¡å—","025W39725-000","2",""],["4-1","ä¸»æ¿å¥—ä»¶","031-00947-000","1",""],["4-1","åŠ çƒ­å™¨","025W48737-201","3",""],["4-1","æ§åˆ¶å™¨","024G00019-027","1",""],["4-2","é£å‹å·®è¡¨","024G00015-010","3",""],["4-2","æ„Ÿæ¸©å…ƒä»¶","022W12605-102","1",""],["4-2","æ¸©åº¦ä¼ æ„Ÿå™¨","024W33669-000","1",""],["4-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025W39721-001","2",""],["4-2","é›†æ§å™¨","025W45462-029","1",""],["4-2","ç”µæº","025-34111-000","1",""],["4-2","å‹åŠ›ä¼ æ„Ÿå™¨","025W28678-101","4",""],["4-2","æ‰§è¡Œå™¨æ”¹è£…ä»¶","025W48243-070","1",""],["4-3","æ§åˆ¶æ¿","025W43786-549","1",""],["4-3","è¾“å‡ºæ¿","025W43786-550","1",""],["4-3","è¾“å‡ºæ¿","025W43786-551","1",""],["4-3","æ²¹æ³µ","026-46984-000","1",""],["4-3","ä¸»æ¿","331-02506-601","1",""],["4-3","æ§åˆ¶æ¿","025W43786-548","1",""],["4-3","å¯¼å¶é©¬è¾¾","025-48232-000","1",""],["4-3","ä¸»æ¿","331-02506-602","1",""],["4-4","I/Oæ¿","031W01743-002","2",""],["4-4","æ‰§è¡Œå™¨","025W38178-001","2",""],["4-4","æ²¹è¿‡æ»¤å™¨","026W32831-000","2",""],["4-4","å‹åŠ›ä¼ æ„Ÿå™¨","025W43790-000","1",""],["4-4","å‹åŠ›ä¼ æ„Ÿå™¨","025W43790-112","1",""],["4-4","ç»§ç”µå™¨","024W30441-000","1",""],["4-4","å•å‘é˜€","025G00039-095","1",""],["4-4","EXVé©±åŠ¨æ¿","024W33786-000","1",""],["4-5","è½´å°","364-47950-000","2",""],["4-5","æ©¡èƒ¶å«","028W18169-002","40",""],["5-1","å‚¨èƒ½æ¨¡å—","371W09552-902","2",""],["5-2","ç”µèƒ½ç®±","SHQNJ-C-003","",""],["5-2","æ•°å­—é’³å½¢åŠŸç‡è®¡","","2",""],["5-2","ç½‘å…³ç®±","","1",""],["5-3","ç»ç¼˜æµ‹è¯•ä»ª","","1",""],["5-3","ç”µèƒ½ç®±","SHQNJ-C-003","1",""],["5-3","ç”µèƒ½ç®±","","1",""],["5-4","è¶…å£°æ³¢æµé‡ä»ª","","2",""],["6é¡¶","ç”µè§†æœº","","1",""],["6é¡¶","å˜é¢‘æŸœå……ç”µå™¨","","1",""],["6-1","æ»‘é˜€ä½ç½®ä¼ æ„Ÿå™¨","371-05520-001","1",""],["6-1","æ°´å®¤å¯†å°æ¡","","3m",""],["6-1","IGBT","","1",""],["6-1","å‹åŠ›å¼€å…³","025W47072-101","1",""],["6-2","ä¸¤ä½ä¸‰é€šé˜€","","2",""],["6-3","åŠ æ²¹æ³µæ²¹ç®¡","","1",""],["6-3","æ¸©åº¦ç®±","SHQNJ-C-003","1",""],["6-4","é’¢ç“¶æ‰‹é˜€","","2",""],["6-4","çˆ†ç ´ç‰‡","","2",""],["6-5","ç”µèƒ½ä»ª","SHQNJ-C-19","1",""],["6-5","èƒ½é‡æ ¸æŸ¥ä»ª","","",""],["7-1","ç”µç£é˜€","022W10820-000","1",""],["7-1","é©¬è¾¾ä¿æŠ¤å™¨","024W31517-005","1",""],["7-2","è”æœºæ¿","025G00033-062","1",""],["7-2","æ¸©åº¦ä¼ æ„Ÿå™¨","035G00037-036","4",""],["7-2","æ¸©åº¦ä¼ æ„Ÿå™¨","035G00037-034","2",""],["7-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025W48195-101","1",""],["7-2","é˜€","022W01378-000","1",""],["7-2","çƒ­ç»§ç”µå™¨","025G00007-005","4",""],["7-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025G00037-011","1",""],["7-2","æ¸©æ§å™¨","025G00013-013","1",""],["7-2","æ§åˆ¶å™¨","4683-TTM-2F","1",""],["7-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025W29964-001","1",""],["7-2","æ²¹æ»¤èŠ¯","026-35601-000","2",""],["7-2","ç”µç£é˜€","025-42378-000","1",""],["7-2","ç”µç£é˜€ä½“","025-26270-012","1",""],["7-2","å«ç‰‡","228-09410-800","2",""],["7-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025L02246-000","1",""],["7-2","å‹åŠ›ä¼ æ„Ÿå™¨","025-28678-104","1",""],["7-2","å‹åŠ›ä¼ æ„Ÿå™¨","P499VBS-404C","1",""],["7-2","é«˜å‹å¼€å…³","025L01401-000","1",""],["7-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025W48195-001","1",""],["7-2","PRVç”µæœºè‡‚","064W51926-000","1",""],["7-2","çƒ­ç»§ç”µå™¨","025G00007-038","6",""],["7-2","ç”µæµäº’æ„Ÿå™¨","025W21173-003","1",""],["7-2","äº¤æµæ¥è§¦å™¨","024G00016-008","1",""],["7-2","ç”µæºä¿æŠ¤å™¨","025W43808-500","1",""],["7-2","å¹²ç‡¥è¿‡æ»¤å™¨","026-37563-000","2",""],["7-2","å››é€šé˜€","951A0113H02","1",""],["7-2","æ´»å¡é’¢å¥—","064W49654-000","2",""],["7-3","ABBæ¥è§¦å™¨","A210-30","3",""],["7-3","å¯†å°ç¯","064-47785-000","1",""],["7-3","æ­¢æ¨ç¯","064-47770-000","1",""],["7-3","æ­¢æ¨ç¯","064-47547-000","1",""],["7-3","æ»‘åŠ¨è½´æ‰¿","064-47544-000","1",""],["7-3","æ»‘åŠ¨è½´æ‰¿","064-47541-000","1",""],["7-3","æ»‘åŠ¨è½´æ‰¿","064-47542-000","1",""],["7-3","æ»‘åŠ¨è½´æ‰¿","064-47543-000","1",""],["7-3","æ­¢æ¨è½´æ‰¿","064-48283-000","1",""],["8-1","é©¬è¾¾ä¿æŠ¤å™¨","024W31517-100","1",""],["8-2","è¾“å‡ºæ¨¡å—","111Q0281061","6",""],["8-2","è¾“å…¥æ¨¡å—","333Q0000789","3",""],["8-2","æ¥å¤´","164929","12",""],["8-2","å•å‘é˜€","956A0053H02","16",""],["8-3","ç”µæº","025-34111-000","1",""],["8-3","ä¸»æ¿","331-03630-601","1",""],["8-3","æ¸©åº¦æ¢å¤´","025W29964-001","1",""],["8-3","å‹åŠ›ä¼ æ„Ÿå™¨","025-28678-104","1",""],["8-3","å¡æ‰£","5760516","5",""],["8-3","å‹åŠ›ä¼ æ„Ÿå™¨","025W40088-000","1",""],["8-3","å‹åŠ›ä¼ æ„Ÿå™¨","025W43790-000","1",""],["8-3","æ²¹å¼•å°„å—","026W46156-000","1",""],["8-3","å¯¼å¶é©¬è¾¾","48234","1",""],["8-3","æ˜¾ç¤ºå±","031-03441-000","1",""],["8-4","æ²¹æ³µ","","2",""],["8-4","è”è½´å™¨å¼¹ç°§ç‰‡","","6",""],["9-1","æ¸©åº¦ä¼ æ„Ÿå™¨","025W00093-010","1",""],["9-2","å‹åŠ›å¼€å…³","024G00013-006","2",""],["9-2","å‹åŠ›å¼€å…³","025L02955-001","1",""],["9-2","æµ‹æ¸©å¥—ç®¡","092W14052-001","1",""],["9-2","ä½å‹å¼€å…³","024G00013-007","1",""],["9-2","é˜€","022W11216-002","1",""],["9-2","YCAEä¸»æ¿","025G00056-109","1",""],["9-2","æ¥è§¦å™¨","025W42500-305","1",""],["9-2","å‹åŠ›æ§åˆ¶å™¨","024G00013-035","3",""],["9-2","æ¸©åº¦ä¼ æ„Ÿå™¨","025G00037-040","3",""],["9-2","ELINK","","1",""],["9-2","å‹åŠ›å¼€å…³","024G00013-038","1",""],["9-2","æ²¹åŠ çƒ­å™¨","015G00002-002","1",""],["9-2","æ°´æµå¼€å…³","024G00009-002","2",""],["9-2","I/Oæ¿","024W33789-800","1",""],["9-2","ä¸‰ç›¸ä¿æŠ¤å™¨","025G00015-005","1",""],["9-2","ç”µç£é˜€","025-35150-104","1",""],["9-2","ä¿é™©ä¸","024G00036-004","1",""],["9-2","å¯†å°ç¯","064-47586-000","1",""],["9-2","è½´å°","464-47820-000","1",""],["9-4","æ§åˆ¶ä¸­å¿ƒ","","1",""],["10-1","å¹²ç‡¥è¿‡æ»¤å™¨","026-32839-000","4",""],["10-1","ç”µæµäº’æ„Ÿå™¨","025W21173-103","2",""],["10-1","ç”µæµäº’æ„Ÿå™¨","025W21173-003","1",""],["10-1","è¿‡æ»¤å™¨","023-20878-001","1",""],["10-1","çƒ­åŠ›è†¨èƒ€é˜€","022W11976-012","1",""],["10-1","å¼¹ç°§","022-10189-000","1",""],["10-1","å‹åŠ›ä¼ æ„Ÿå™¨","025L01917-000","1",""],["10-1","çƒ­åŠ›è†¨èƒ€é˜€","022-10961-004","1",""],["10-1","è†¨èƒ€é˜€èŠ¯","022-10184-000","1",""],["10-1","å¹²ç‡¥è¿‡æ»¤å™¨","026-32841-000","3",""],["10-1","æ²¹æ»¤","392-10719-000","2",""],["10-1","æ²¹æ»¤","026-32386-000","1",""],["10-1","èºæ¯","023W18287-000","2",""],["10-1","ç»§ç”µå™¨æ¿","025W43786-551","1",""],["10-1","çƒ­åŠ›è†¨èƒ€é˜€","KT-83-VCP100","2",""],["10-1","æ’æ¸©å¥—ä»¶","362G52475A032","1",""],["10-1","æ²¹æ»¤","026W36838-000","1",""],["10-1","çº¿åœˆ","025-16572-001","1",""],["10-2","ç”µå­è†¨èƒ€é˜€","","1",""],["10-3","æ¸©åº¦ä¼ æ„Ÿå™¨","025G00037-011","1",""],["10-3","è½´æ‰¿","029-22451-000","1",""],["10-3","ç»§ç”µå™¨ABB","1161867","1",""],["10-3","YKé”®ç›˜","5443010","1",""],["11-1","å¼¹ç°§","534B0020H01","1",""],["11-1","å¼¹ç°§","534B0036H01","1",""],["11-1","å¼¹ç°§","534C0595G04","1",""],["11-2","é˜€","025-42245-015","1",""],["11-2","è¿‡æ»¤å™¨","026W51712-000","2",""],["11-3","å¹²ç‡¥è¿‡æ»¤å™¨","026-28173-000","5",""],["11-3","æ²¹æ»¤èŠ¯","026W36838-000","1",""],["11-3","åŠ çƒ­å¸¦","025G00042-036","6",""],["11-3","å¹²ç‡¥è¿‡æ»¤å™¨","026-13508-000","6",""],["11-3","è†¨èƒ€é˜€ä½“","022-10183-000","1",""],["11-4","æ‰‹è½®æˆªæ­¢é˜€","022W11216-006","2",""],["11-4","æ°´æ³µ","","3",""],["12-1","æ‰‹åŠ¨é˜€","022W10086-106","1",""],["12-2","è½´å°","534C0701H06","1",""],["12-2","å¼•å°„å—","026-35381-000","1",""],["12-3","ç©ºå¼€","","5",""],["12-3","YFSæ»‘é˜€ç»„ä»¶","","1",""],["12-4","ç§°","","1",""],["12-4","å˜å‹å™¨","","1",""],["13-1","æ²¹è§†é•œ","026-17581-000","3",""],["13-1","æ°´æµå¼€å…³","","2",""],["13-1","æ˜¾ç¤ºå±","025W42576-001","2",""],["13-1","å£°å…‰æŠ¥è­¦å™¨","","1",""],["13-1","å¯¼å¶é©¬è¾¾","025-48233-000","1",""],["13-2","çº¿åœˆ","023-0088-00","2",""],["13-2","é˜€","010-0125-00","2",""],["13-2","å®‰å…¨é˜€","022-10045-000","2",""],["13-2","PRVè½´","364-29573-000","1",""],["13-2","è½´æ‰¿","029-22450-000","1",""],["13-2","å®‰å…¨é˜€","022W10079-000","1",""],["13-2","å®‰å…¨é˜€","022W12520-000","4",""],["13-2","å®‰å…¨é˜€","022W09505-000","1",""],["13-2","æ¥çº¿æ¿","064W52142-000","1",""],["13-2","ç»§ç”µå™¨","333Q0000897","2",""],["13-2","ç»§ç”µå™¨","333Q0001095","1",""],["13-2","æ¥çº¿ç›’ç›–","","1ç®±",""],["13-3","å«ç‰‡","064-47451-000","1",""],["13-3","å«ç‰‡","028W15712-002","1",""],["13-3","å«ç‰‡","028W15787-007","1",""],["13-3","å«ç‰‡","028-15075-062","3",""],["13-3","å«ç‰‡","028W15712-007","1",""],["13-3","å«ç‰‡","028W14166-013","1",""],["13-3","å«ç‰‡","028-15075-061","1",""],["13-4","æ°´æ³µ","","2",""],["æœªè®°å½•","Kæ²¹","","28",""],["æœªè®°å½•","Sæ²¹","","10",""],["æœªè®°å½•","13#æ²¹","","2",""],["æœªè®°å½•","R134a","","28",""],["æœªè®°å½•","R22","","2",""]
];

// å€Ÿå‡ºæµæ°´è´¦ï¼š[æ—¥æœŸ, é›¶ä»¶å, é›¶ä»¶å·, æ•°é‡, é¢†ç”¨äºº, æ˜¯å¦å½’è¿˜(0/1), åŸåº“å­˜ç´¢å¼•]
let history = JSON.parse(localStorage.getItem('history_data')) || [];

function save() {
    localStorage.setItem('parts_data', JSON.stringify(parts));
    localStorage.setItem('history_data', JSON.stringify(history));
}

// æœç´¢åŠŸèƒ½
function handleSearch() {
    const q = document.getElementById('searchInput').value.trim().toLowerCase();
    const area = document.getElementById('displayArea');
    const tbody = document.getElementById('tBody');
    const thead = document.getElementById('tHead');

    if(!q) { area.style.display = 'none'; return; }

    const results = parts.filter(p => p[0].toLowerCase().includes(q) || p[1].toLowerCase().includes(q) || p[2].toLowerCase().includes(q));

    area.style.display = 'block';
    thead.innerHTML = `<tr><th>åº“ä½</th><th>é›¶ä»¶ä¿¡æ¯</th><th>åº“å­˜</th><th>æ“ä½œ</th></tr>`;
    tbody.innerHTML = results.map(p => {
        const originIdx = parts.indexOf(p);
        return `<tr>
            <td><span class="loc-tag">${p[0]}</span></td>
            <td>${p[1]}<br><small style="color:#666">${p[2]}</small></td>
            <td>${p[3]}</td>
            <td><button class="btn-blue" style="padding:5px 10px" onclick="borrowItem(${originIdx})">å€Ÿå‡º</button></td>
        </tr>`;
    }).join('');
}

// å€Ÿå‡ºæ“ä½œ
function borrowItem(idx) {
    const p = parts[idx];
    const person = prompt(`å€Ÿå‡ºï¼š${p[1]}\nè¯·è¾“å…¥é¢†ç”¨äººï¼š`);
    if(!person) return;
    const num = parseInt(prompt("è¯·è¾“å…¥å€Ÿå‡ºæ•°é‡ï¼š", "1"));
    if(isNaN(num) || num > parseInt(p[3]) || num <= 0) return alert("æ•°é‡ä¸ç¬¦æˆ–åº“å­˜ä¸è¶³");

    // æ›´æ–°åº“å­˜
    parts[idx][3] = parseInt(p[3]) - num;
    // æ’å…¥æµæ°´è´¦ (æ”¾åœ¨æœ€å‰é¢)
    history.unshift([new Date().toLocaleDateString(), p[1], p[2], num, person, 0, idx]);
    
    save();
    handleSearch();
    alert("å€Ÿå‡ºç™»è®°æˆåŠŸï¼");
}

// æ˜¾ç¤ºæ¸…å•è®°å½•
function showHistory() {
    const area = document.getElementById('displayArea');
    const tbody = document.getElementById('tBody');
    const thead = document.getElementById('tHead');
    
    area.style.display = 'block';
    thead.innerHTML = `<tr><th>æ—¥æœŸ</th><th>é¢†ç”¨äºº/é›¶ä»¶</th><th>æ•°é‡</th><th>çŠ¶æ€</th></tr>`;
    
    if(history.length === 0) {
        tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;padding:20px;color:#999">æš‚æ— å€Ÿå‡ºè®°å½•</td></tr>';
        return;
    }

    tbody.innerHTML = history.map((h, i) => `
        <tr class="${h[5] ? 'returned' : ''}">
            <td>${h[0]}</td>
            <td><b>${h[4]}</b><br>${h[1]}</td>
            <td>${h[3]}</td>
            <td>
                ${h[5] ? 'âœ… å·²è¿˜' : `<button class="btn-orange" style="padding:5px 10px" onclick="returnItem(${i})">å½’è¿˜</button>`}
            </td>
        </tr>
    `).join('');
}

// å½’è¿˜æ“ä½œ
function returnItem(historyIdx) {
    const h = history[historyIdx];
    // è‡ªåŠ¨åŠ å›åº“å­˜
    const pIdx = h[6];
    parts[pIdx][3] = parseInt(parts[pIdx][3]) + h[3];
    // æ ‡è®°å·²è¿˜
    history[historyIdx][5] = 1;
    
    save();
    showHistory();
    alert("å½’è¿˜æˆåŠŸï¼Œåº“å­˜å·²æ›´æ–°ï¼");
}
</script>
</body>
</html>
